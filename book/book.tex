%!TEX program = xelatex

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% book template
%% WisdomFusion@gmail.com
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass{ctexbook}
\usepackage{fontspec}
\usepackage{xunicode}
\usepackage{geometry}
\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{enumerate}
%% \usepackage{amsmath,mathrsfs,amsfonts}
\usepackage[x11names]{xcolor}
\usepackage{titletoc}
\usepackage{titlesec}
\usepackage{tabularx}
\usepackage{booktabs}
\usepackage{colortbl}
\usepackage{multirow,makecell}
\usepackage{ulem} % \uline
\usepackage{multicol}
\usepackage{lipsum}

\usepackage{hyperref}
\hypersetup{
  bookmarksnumbered,
  colorlinks,
  linkcolor={red!50!black},
  citecolor={blue!50!black},
  urlcolor={blue!80!black}
}

\linespread{1.3}

\geometry{
  a4paper,
  left=27mm,  %% or inner=23mm
  right=27mm, %% or outer=18mm
  top=25.4mm, bottom=25.4mm,
  headheight=2.17cm,
  headsep=4mm,
  footskip=12mm
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% fonts settings
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% \usepackage{ebgaramond}

\setmainfont[Ligatures=TeX]{Minion Pro}
\setsansfont{Myriad Pro}
\setmonofont{Inconsolata}

\setCJKmainfont[BoldFont={方正小标宋_GBK}, ItalicFont={方正楷体_GBK}]{方正书宋_GBK}
\setCJKsansfont{方正黑体_GBK}
\setCJKmonofont{方正中等线_GBK}

\XeTeXlinebreaklocale "zh"
\XeTeXlinebreakskip = 0pt plus 1pt

%% \newfontfamily\fzss{方正书宋_GBK}
%% \newfontfamily\fzxbs{方正小标宋_GBK}
%% \newfontfamily\fzhei{方正黑体_GBK}
%% \newfontfamily\fzkai{方正楷体_GBK}
\newfontfamily\fzfs{方正仿宋_GBK}
\newfontfamily\fzzdx{方正中等线_GBK}

\newfontfamily\garamond{Adobe Garamond Pro}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% titlesec
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\titleformat
{\chapter} % command
[display] % shape
{\bfseries\Large} % format
{第 \thechapter 章} % label
{0.5ex} % sep
{
  \rule{\textwidth}{1.5pt}
  \vspace{1ex}
  \centering
} % before-code
[
\vspace{-0.5ex}%
\rule{\textwidth}{0.5pt}
] % after-code

\titleformat{\section}[hang]{\sffamily}
{\hspace{-2.45em}\Large\textbf{\thesection}\enspace}{1pt}{\Large\bfseries\filright}

\titleformat{\subsection}[hang]{\sffamily}
{\large\textbf{\thesubsection}\enspace}{1pt}{\large\bfseries\filright}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% 中文结构
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\makeatletter
\renewcommand\part{%
   \if@openright
     \cleardoublepage
   \else
     \clearpage
   \fi
   \thispagestyle{empty}%
   \if@twocolumn
     \onecolumn
     \@tempswatrue
   \else
     \@tempswafalse
   \fi
   \null\vfil
   \secdef\@part\@spart}
\makeatother

\renewcommand{\contentsname}{目\hspace{1em}录}
\renewcommand{\figurename}{图}
\renewcommand{\tablename}{表}
\renewcommand{\partname}{部分}
\renewcommand{\listfigurename}{\bfseries 插图目录}
\renewcommand{\listtablename}{\bfseries 表格目录}
\renewcommand{\bibname}{\bfseries 参考文献}
\renewcommand{\appendixname}{\bfseries 附\hspace{2em}录}
\renewcommand{\indexname}{\bfseries 索\hspace{2em}引}

%% 解决目录文字重叠
\makeatletter
\renewcommand{\numberline}[1]{%
\settowidth\@tempdimb{#1\hspace{0.5em}}%
\ifdim\@tempdima<\@tempdimb%
  \@tempdima=\@tempdimb%
\fi%
\hb@xt@\@tempdima{\@cftbsnum #1\@cftasnum\hfil}\@cftasnumb}
\makeatother

\title{\Huge \textbf{Book Title 中文标题}}
\author{\LARGE 胡志飞\hspace{1em}著}
\date{\today}

\begin{document}


\maketitle
\thispagestyle{empty}

\frontmatter

\chapter*{序}
\addcontentsline{toc}{chapter}{序}

本书作序。

\clearpage\thispagestyle{empty}


\tableofcontents
\clearpage\thispagestyle{empty}


\mainmatter

\part{中文的部分标题}

\chapter{中文的章标题}

\lipsum[3]

\clearpage

\section{中文的节标题}

\lipsum[3]


\section{English section title}

\lipsum[2-5]

\chapter{English chapter title}

\section{再来一个小节}

该小节的内容。


\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
